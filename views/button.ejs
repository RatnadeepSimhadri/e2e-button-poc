<html>
<head>
    <title>Button Component</title>
    <script src="/dist/sdk.umd.js"></script>
    <style>
        .custom-button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        .custom-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body style="margin: 0; padding: 0;">
<button id="myButton" class="custom-button"><%= buttonText %></button>
<script>

    document.addEventListener('DOMContentLoaded', () => {
        let popupInstance = null;
        let isClosing = false;

        async function renderPopup() {
            if (popupInstance || isClosing) return;

            try {

                const { PopupComponent } = window.paypal;

                popupInstance = PopupComponent({
                    createOrder: async () => {
                        const response =  await  window.xprops.createOrder();
                        console.log(response);
                        return response;
                    },
                    onClose: () => {
                        console.log("Popup Closed");
                        popupInstance = null;
                    },
                    orderID: ''
                });

                await popupInstance.render();
            } catch (error) {
                console.error('Error showing modal:', error);
            }
        }
        document.getElementById('myButton').addEventListener('click', renderPopup);
        document.getElementById('myButton').innerHTML = window.xprops.buttonText;
    })

</script>
</body>
</html>